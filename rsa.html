<!--
=========================================================
* * Black Dashboard - v1.0.1
=========================================================

* Product Page: https://www.creative-tim.com/product/black-dashboard
* Copyright 2019 Creative Tim (https://www.creative-tim.com)


* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="assets/img/favicon.png">
  <title>
    RSA
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="assets/css/nucleo-icons.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link href="assets/css/black-dashboard.css?v=1.0.0" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="assets/demo/demo.css" rel="stylesheet" />
<style> .dragbox {
    width: 400px;
    height: 150px;
    margin: auto;
    text-align: center;
    background-color: #ffffff;
    border: 2px solid #01293c;
    animation: progress-bar-stripes 1s linear infinite;
}

.progress-bar-striped {
    background-image: linear-gradient(45deg,
            hsla(23, 100%, 50%, 0.15) 25%,
            transparent 0,
            transparent 50%,
            hsla(0, 0%, 100%, 0.15) 0,
            hsla(0, 0%, 100%, 0.15) 75%,
            transparent 0,
            transparent);
    background-size: 1rem 1rem;
}

.dragbox-over {
    background-color: #4cb9f9;
}

.text-vertical-center {
    position: relative;
    top: 50%;
    transform: translate(0, -50%);
}
</style>
  
</head>

<body class="">
  <div class="wrapper">
    <div class="sidebar">
      <!--
        Tip 1: You can change the color of the sidebar using: data-color="blue | green | orange | red"
    -->
      <div class="sidebar-wrapper">
        <div class="logo">
          <a href="javascript:void(0)" class="simple-text logo-mini">
            
          </a>
          <a href="javascript:void(0)" class="simple-text logo-normal">
           CREXT
          </a>
        </div>
        <ul class="nav">
          <li>
            <a href="aes.php">
              <i class="tim-icons icon-chart-pie-36"></i>
              <p>Aes</p>
            </a>
          </li>
          <li>
            <a href="rsa.html">
              <i class="tim-icons icon-atom"></i>
              <p>RSA</p>
            </a>
          </li>
          <li>
            <a href="index.html">
              <i class="tim-icons icon-bank"></i>
              <p>beranda</p>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="main-panel">
      
      
      <div class="content">
        <div class="row">
          <div class="col-md-12">
            <div class="card">
              <div class="card-header mb-5">
                
              </div>
              <div class="card-body">
                <div class="container-xxl py-2">
                    <div class="container">
                        
                        
                        <div class="container">
                            
                                <div class="card card-body">
            
                                    <div class="row p-5 border mt-4">
                                        <h2 class="col-12 text-center pb-3">Simulasi RSA</h2>
                                        <label>Kunci Publik</label>
                                        <textarea id="pub" rows="5" class="col-12" readonly></textarea>
                                        <label>Kunci Privat</label>
                                        <textarea id="pri" rows="5" class="col-12" readonly></textarea>
                                        <div class="col-12 text-center mt-3 mb-3">
                                            <button class="btn btn-secondary" onclick="getRsaKeys()">
                                                Refresh Kunci
                                            </button>
                                        </div>
                                    </div>
                                    <div class="row p-5 border mt-4">
                                        <h2 class="col-12 text-center pb-5">
                                            Plaintext Encrypts dan Decrypts RSA
                                        </h2>
                                        <label>Plaintext </label>
                                        <textarea class="col-12" rows="1" id="plainText"></textarea>
                                        <div class="col-12 text-center mt-3 mb-3">
                                            <button class="btn btn-info" onclick="encryptRSA()">
                                                Encrypts
                                            </button>
                                        </div>
                                        <label>Encrypts Text </label>
                                        <textarea class="col-12" rows="3" id="encryptedText"></textarea>
                                        <div class="col-12 text-center mt-3">
                                            <button class="btn btn-warning" onclick="decryptRSA()">
                                                Decrypts
                                            </button>
                                        </div>
                                        <label>Decrypts Text</label>
                                        <textarea class="col-12" rows="1" id="decryptedText"></textarea>
                                    </div>
                                    <div class="row p-5 border mt-4">
                                        
                                        <h2 class="col-12 text-center pb-3">
                                            Encrypts File RSA<br>
                                           
                                        </h2><br>
                                        
                                        
                                        <div class="dragbox mt-2 mb-4 text-center" id="encryptionDropBox">
                                            <p class="text-vertical-center-danger">
                                                <strong>Drag File Disini Untuk Encrypts</strong>
                                            </p>
                                        </div>
                                        <h4 class="col-12 text-center pb-3">Drag File Disini Untuk Encrypts</h4>
                                        <br>
                                        <h2 class="col-12 text-center pb-3">
                                            Decrypts File RSA
                                        </h2>
                                        <div class="dragbox mt-2 text-center" id="decryptionDropBox">
                                            <p class="text-vertical-center">
                                                <strong>Drag File Disini Untuk Decrypts</strong>
                                            </p>
                                        </div>
                                        <br><h4 class="col-12 text-center pb-3">Drag File Disini Untuk Decrypts</h4>
                                    </div>
            
                                </div>
                            </div>
                                   
            </div>
          </div>
        </div>
      </div>
      <footer class="footer">
        <div class="container-fluid">
          <ul class="nav">
            <li class="nav-item">
              
            </li>
            <li class="nav-item">
              
            </li>
            <li class="nav-item">
              
            </li>
          </ul>
          <div class="copyright">
           
          </div>
        </div>
      </footer>
    </div>
  </div>
  
  <!--   Core JS Files   -->
  <script src="assets/js/core/jquery.min.js"></script>
  <script src="assets/js/core/popper.min.js"></script>
  <script src="assets/js/core/bootstrap.min.js"></script>
  <script src="assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!--  Google Maps Plugin    -->
  <!-- Place this tag in your head or just before your close body tag. -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
  <!-- Chart JS -->
  <script src="assets/js/plugins/chartjs.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Black Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="assets/js/black-dashboard.min.js?v=1.0.0"></script><!-- Black Dashboard DEMO methods, don't include it in your project! -->
  <script src="assets/demo/demo.js"></script>
   <!-- Template Javascript -->
   <script src="js/main.js"></script>

   <!-- Template Main JS File -->
   <script src="assets/js/main.js"></script>

   <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
   integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
</script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
   integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous">
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
   integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.0.0-rc.1/jsencrypt.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="lib/wow/wow.min.js"></script>
<script src="lib/easing/easing.min.js"></script>
<script src="lib/waypoints/waypoints.min.js"></script>
<script src="lib/owlcarousel/owl.carousel.min.js"></script>

  <script>
    $(document).ready(function() {
      $().ready(function() {
        $sidebar = $('.sidebar');
        $navbar = $('.navbar');
        $main_panel = $('.main-panel');

        $full_page = $('.full-page');

        $sidebar_responsive = $('body > .navbar-collapse');
        sidebar_mini_active = true;
        white_color = false;

        window_width = $(window).width();

        fixed_plugin_open = $('.sidebar .sidebar-wrapper .nav li.active a p').html();



        $('.fixed-plugin a').click(function(event) {
          if ($(this).hasClass('switch-trigger')) {
            if (event.stopPropagation) {
              event.stopPropagation();
            } else if (window.event) {
              window.event.cancelBubble = true;
            }
          }
        });

        $('.fixed-plugin .background-color span').click(function() {
          $(this).siblings().removeClass('active');
          $(this).addClass('active');

          var new_color = $(this).data('color');

          if ($sidebar.length != 0) {
            $sidebar.attr('data', new_color);
          }

          if ($main_panel.length != 0) {
            $main_panel.attr('data', new_color);
          }

          if ($full_page.length != 0) {
            $full_page.attr('filter-color', new_color);
          }

          if ($sidebar_responsive.length != 0) {
            $sidebar_responsive.attr('data', new_color);
          }
        });

        $('.switch-sidebar-mini input').on("switchChange.bootstrapSwitch", function() {
          var $btn = $(this);

          if (sidebar_mini_active == true) {
            $('body').removeClass('sidebar-mini');
            sidebar_mini_active = false;
            blackDashboard.showSidebarMessage('Sidebar mini deactivated...');
          } else {
            $('body').addClass('sidebar-mini');
            sidebar_mini_active = true;
            blackDashboard.showSidebarMessage('Sidebar mini activated...');
          }

          // we simulate the window Resize so the charts will get updated in realtime.
          var simulateWindowResize = setInterval(function() {
            window.dispatchEvent(new Event('resize'));
          }, 180);

          // we stop the simulation of Window Resize after the animations are completed
          setTimeout(function() {
            clearInterval(simulateWindowResize);
          }, 1000);
        });

        $('.switch-change-color input').on("switchChange.bootstrapSwitch", function() {
          var $btn = $(this);

          if (white_color == true) {

            $('body').addClass('change-background');
            setTimeout(function() {
              $('body').removeClass('change-background');
              $('body').removeClass('white-content');
            }, 900);
            white_color = false;
          } else {

            $('body').addClass('change-background');
            setTimeout(function() {
              $('body').removeClass('change-background');
              $('body').addClass('white-content');
            }, 900);

            white_color = true;
          }


        });

        $('.light-badge').click(function() {
          $('body').addClass('white-content');
        });

        $('.dark-badge').click(function() {
          $('body').removeClass('white-content');
        });
      });
    });
  </script>
  <script src="https://cdn.trackjs.com/agent/v3/latest/t.js"></script>
  <script>
    window.TrackJS &&
      TrackJS.install({
        token: "ee6fab19c5a04ac1a32a645abde4613a",
        application: "black-dashboard-free"
      });
  </script>
  
  
  <script>
    var publicKey = "";
    var privateKey = "";

    window.onload = () => {
        getRsaKeys();
    };

    $("#encryptionDropBox").on("dragover", function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).addClass("dragbox-over");
    });
    $("#encryptionDropBox").on("dragleave", function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).removeClass("dragbox-over");
    });
    $("#encryptionDropBox").on("drop", function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).addClass("progress-bar-striped");
        var file = evt.originalEvent.dataTransfer.files[0];
        setTimeout(async () => {
            await fileEncryptRSA(file);
            $(this).removeClass("progress-bar-striped");
            $(this).removeClass("dragbox-over");
        }, 1000);
    });
    $("#decryptionDropBox").on("dragover", function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).addClass("dragbox-over");
    });
    $("#decryptionDropBox").on("dragleave", function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).removeClass("dragbox-over");
    });
    $("#decryptionDropBox").on("drop", function (evt) {
        evt.preventDefault();
        evt.stopPropagation();
        $(this).addClass("progress-bar-striped");
        var file = evt.originalEvent.dataTransfer.files[0];
        setTimeout(async () => {
            await fileDecryptRSA(file);
            $(this).removeClass("progress-bar-striped");
            $(this).removeClass("dragbox-over");
        }, 1000);
    });
    //plainText encryption (max = 117)
    function encryptRSA(data) {
        if (data === undefined) {
            data = $("#plainText").val();
        }
        var encrypt = new JSEncrypt();
        encrypt.setPublicKey(publicKey);
        var result =
            encrypt.encrypt(data) == null ? "Failed" : encrypt.encrypt(data);
        document.getElementById("encryptedText").value = result;
        return result;
    }
    //plainText decryption (max = 172)
    function decryptRSA(data) {
        if (data === undefined) {
            data = $("#encryptedText").val();
        }
        var decrypt = new JSEncrypt();
        decrypt.setPrivateKey(privateKey);
        var result =
            decrypt.decrypt(data) == null ? "Failed" : decrypt.decrypt(data);
        document.getElementById("decryptedText").value = result;
        return result;
    }

    //read file in 10 based which convert from 8 bits binary, then encrypt the bytecode
    function fileEncryptRSA(file) {
        var filename = file.name;
        var reader = new FileReader();
        reader.readAsArrayBuffer(file);
        reader.onload = function (evt) {
            if (evt.target.readyState == FileReader.DONE) {
                var arrayBuffer = evt.target.result;
                var arrayString = new Uint8Array(arrayBuffer).toString();
                var encrypt = new JSEncrypt();
                encrypt.setPublicKey(document.getElementById("pub").value);
                var maxLength = 117;
                var count =
                    Math.ceil(arrayString.length / maxLength) > 0 ?
                    Math.ceil(arrayString.length / maxLength) :
                    1;
                var encryptedData = "";
                for (let i = 0; i < count; i++) {
                    var temp = "";
                    for (
                        let ii = i * maxLength; ii < (i + 1) * maxLength && ii < arrayString.length; ii++
                    ) {
                        temp += arrayString[ii];
                    }
                    encryptedData += encrypt.encrypt(temp);
                }
                downFlie(encryptedData, "encrypted." + filename + ".sc.encrypt");
            }
        };
    }

    //read file in 10 based which convert from 8 bits binary, then decrypt the encrypted text
    function fileDecryptRSA(file) {
        var filename = file.name;
        var reader = new FileReader();
        reader.readAsArrayBuffer(file);
        reader.onload = function (evt) {
            if (evt.target.readyState == FileReader.DONE) {
                var arrayBuffer = evt.target.result;
                var array = new Uint8Array(arrayBuffer);
                var decrypt = new JSEncrypt();
                decrypt.setPrivateKey(document.getElementById("pri").value);
                var maxBufferLength = 172;
                var count =
                    Math.ceil(array.length / maxBufferLength) > 0 ?
                    Math.ceil(array.length / maxBufferLength) :
                    1;
                var decryptedBin = "";
                for (var i = 0; i < count; i++) {
                    var temp = "";
                    for (
                        var ii = i * maxBufferLength; ii < (i + 1) * maxBufferLength && ii < array.length; ii++
                    ) {
                        temp += String.fromCharCode(array[ii]);
                    }
                    decryptedBin += decrypt.decrypt(temp); //10 base numbers for each byte
                }

                decryptedBin = decryptedBin.split(",");
                var decryptedData = [];
                decryptedBin.forEach((element) => {
                    decryptedData.push(parseInt(element));
                });
                decryptedData = new Uint8Array(decryptedData);
                downFlie(
                    decryptedData.buffer,
                    "decrypted." +
                    filename.replace("encrypted.", "").replace(".sc.encrypt", "")
                );
            }
        };
    }

    //download file
    function downFlie(buffer, filename) {
        var elementA = document.createElement("a");
        elementA.download = filename;
        elementA.style.display = "none";
        try {
            var file = new Blob([buffer]);
            elementA.href = URL.createObjectURL(file);
            document.body.appendChild(elementA);
            elementA.click();
            document.body.removeChild(elementA);
        } catch (e) {
            console.log(e);
        }
    }
</script>
<script>
    function getRsaKeys(func) {
        window.crypto.subtle
            .generateKey({
                    name: "RSA-OAEP",
                    modulusLength: 1024, //can be 1024, 2048, or 4096
                    publicExponent: new Uint8Array([0x01, 0x00, 0x01]),
                    hash: {
                        name: "SHA-512"
                    }, //can be "SHA-1", "SHA-256", "SHA-384", or "SHA-512"
                },
                true, //whether the key is extractable (i.e. can be used in exportKey)
                ["encrypt", "decrypt"] //must be ["encrypt", "decrypt"] or ["wrapKey", "unwrapKey"]
            )
            .then(function (key) {
                window.crypto.subtle
                    .exportKey("pkcs8", key.privateKey)
                    .then(function (priKeyBuffer) {
                        window.crypto.subtle
                            .exportKey("spki", key.publicKey)
                            .then(function (pubKeyBuffer) {
                                privateKey = RSA2text(priKeyBuffer, 1);
                                publicKey = RSA2text(pubKeyBuffer);
                                document.getElementById("pub").value = publicKey;
                                document.getElementById("pri").value = privateKey;
                            })
                            .catch(function (err) {
                                console.log(err);
                            });
                    })
                    .catch(function (err) {
                        console.log(err);
                    });
            })
            .catch(function (err) {
                console.log(err);
            });
    }

    function RSA2text(buffer, isPrivate = 0) {
        var binary = "";
        var bytes = new Uint8Array(buffer);
        var len = bytes.byteLength;
        for (var i = 0; i < len; i++) {
            binary += String.fromCharCode(bytes[i]);
        }
        var base64 = window.btoa(binary);
        var text =
            "-----BEGIN " + (isPrivate ? "PRIVATE" : "PUBLIC") + " KEY-----\n";
        text += base64
            .replace(/[^\x00-\xff]/g, "$&\x01")
            .replace(/.{64}\x01?/g, "$&\n");
        text += "\n-----END " + (isPrivate ? "PRIVATE" : "PUBLIC") + " KEY-----";
        return text;
    }
</script>
</body>

</html>